ğŸš€ Grabber â€“ Windows Security Log Extractor (PowerShell)
ğŸ” Overview
Grabber is a lightweight PowerShell script that extracts important Windows Security events and exports them into a clean JSON file.

It helps identify:

authentication attempts

privilege escalations

account changes

process creations

â€¦without digging manually through Event Viewer.

This project is part of my learning path in Windows administration and defensive security.

âœ¨ Features
ğŸ” Reads the Security event log (admin rights required)

ğŸ¯ Filters only highâ€‘value Event IDs

â±ï¸ Analyzes the last 24 hours

ğŸ“„ Exports results to a JSON file

ğŸ§© Lightweight and readâ€‘only

ğŸ’» Works on Windows 10/11

ğŸ“Œ Event IDs Covered
Event ID	Description
4625	Failed logon attempt
4672	Special privileges assigned to a new logon
4688	New process created
4720	User account created
4728	User added to a security group
4648	Logon using explicit credentials
1149	Successful RDP connection
ğŸ§© Script (Grabber.ps1)
powershell
# Grabber - Windows Security Log Extractor
# Author: Ryan
# Usage: Run PowerShell as Administrator

$StartTime = (Get-Date).AddHours(-24)
$EventIDs = 4625, 4672, 4688, 4720, 4728, 4648, 1149

$Logs = Get-WinEvent -FilterHashtable @{
    LogName   = 'Security'
    Id        = $EventIDs
    StartTime = $StartTime
} -ErrorAction SilentlyContinue |
Select-Object TimeCreated, Id, LevelDisplayName, ProviderName, Message

$OutputPath = "$env:USERPROFILE\Desktop\logs_compromission.json"
$Logs | ConvertTo-Json -Depth 5 | Out-File $OutputPath

Write-Host "Analysis complete. File exported to: $OutputPath"
ğŸ“Š Example Analysis
âœ”ï¸ Event 4672 â€” Special privileges assigned
Generated by the SYSTEM account (S-1-5-18, NT AUTHORITY, logon ID 0x3E7).
â¡ï¸ Normal system activity (services starting, internal processes).

âœ”ï¸ Event 4648 â€” Logon using explicit credentials
Triggered by svchost.exe using my local user account on 127.0.0.1.
â¡ï¸ Typical of scheduled tasks or services.

No suspicious activity detected.

ğŸ› ï¸ How to Analyze the JSON Output
Load the file
powershell
$logs = Get-Content .\logs_compromission.json | ConvertFrom-Json
Group by Event ID
powershell
$logs | Group-Object Id | Sort-Object Count -Descending
Inspect a specific event
powershell
$logs | Where-Object { $_.Id -eq 4648 } | Format-List *
Sort chronologically
powershell
$logs | Sort-Object TimeCreated | Format-Table -AutoSize
ğŸ¯ Why I Built This
Iâ€™m improving my skills in:

Windows administration

PowerShell scripting

Event log analysis

Defensive security

This project helps me practice realâ€‘world techniques while building a portfolio of useful tools.

ğŸš€ Future Improvements
ğŸ“„ HTML reporting

ğŸ”¥ Severity scoring

ğŸ›¡ï¸ Sysmon integration

â±ï¸ Realâ€‘time monitoring

ğŸ”— Event correlation logic

ğŸ“¦ Requirements
Windows 10/11

PowerShell 5+ or PowerShell 7

Administrator privileges
