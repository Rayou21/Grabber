# üõ°Ô∏è Grabber ‚Äì Windows Security Log Extractor (PowerShell)

![PowerShell](https://img.shields.io/badge/PowerShell-5+-blue?logo=powershell) 
![Windows](https://img.shields.io/badge/OS-Windows%2010%2F11-green?logo=windows) 
![JSON](https://img.shields.io/badge/Output-JSON-orange?logo=json) 
![License](https://img.shields.io/badge/License-MIT-lightgrey)

**Grabber** is a lightweight PowerShell script that extracts high-value events from the Windows **Security** log and exports them into a clean JSON file.

Designed for **blue-team practice** and defensive security learning.

---

## üìù Overview

Grabber helps quickly identify:

- üîê Authentication attempts  
- üö® Privilege escalations  
- üë§ Account modifications  
- ‚öôÔ∏è Process creations  

Instead of manually browsing Event Viewer, Grabber provides a **fast, structured overview** of potentially relevant security activity.

This project is part of my learning journey in:

- Windows Administration  
- PowerShell scripting  
- Defensive Security  

---

## ‚ú® Features

- Reads the Security event log (Administrator privileges required)  
- Filters high-value Event IDs  
- Analyzes the last 24 hours  
- Exports structured output to **JSON**  
- Lightweight and read-only  
- Compatible with Windows 10 / 11  

---

## üéØ Event IDs Covered

| Event ID | Description |
|----------|------------|
| 4625 | Failed logon attempt |
| 4672 | Special privileges assigned to a new logon |
| 4688 | New process created |
| 4720 | User account created |
| 4728 | User added to a security group |
| 4648 | Logon using explicit credentials |
| 1149 | Successful RDP connection |

---

## üíª Script ‚Äì Grabber.ps1

```powershell
# Grabber - Windows Security Log Extractor
# Author: Ryan
# Usage: Run PowerShell as Administrator

$StartTime = (Get-Date).AddHours(-24)
$EventIDs = 4625, 4672, 4688, 4720, 4728, 4648, 1149

$Logs = Get-WinEvent -FilterHashtable @{
    LogName   = 'Security'
    Id        = $EventIDs
    StartTime = $StartTime
} -ErrorAction SilentlyContinue |
Select-Object TimeCreated, Id, LevelDisplayName, ProviderName, Message

$OutputPath = "$env:USERPROFILE\Desktop\logs_compromission.json"
$Logs | ConvertTo-Json -Depth 5 | Out-File $OutputPath

Write-Host "Analysis complete. File exported to: $OutputPath"
```

---

## üîé Example Analysis

### Event 4672 ‚Äì Special Privileges Assigned

All events of this type were generated by:

- SYSTEM  
- S-1-5-18  
- NT AUTHORITY  
- Logon ID 0x3E7  

This is **normal system activity** (services starting, internal processes).

---

### Event 4648 ‚Äì Logon Using Explicit Credentials

One event showed explicit credential usage by my local user account:

- Process: svchost.exe  
- Source: 127.0.0.1  

This is typical of scheduled tasks or services running under a user context.

‚úÖ No suspicious activity was detected in this dataset.

---

## üß™ How to Analyze the JSON Output

### Load the file

```powershell
$logs = Get-Content .\logs_compromission.json | ConvertFrom-Json
```

### Group by Event ID

```powershell
$logs | Group-Object Id | Sort-Object Count -Descending
```

### Inspect a specific event

```powershell
$logs | Where-Object { $_.Id -eq 4648 } | Format-List *
```

### Sort chronologically

```powershell
$logs | Sort-Object TimeCreated | Format-Table -AutoSize
```

---

## üéì Why I Built This

I am improving my skills in:

- Windows Administration  
- PowerShell scripting  
- Event log analysis  
- Defensive security  

This project allows me to **practice real-world blue-team techniques** while building a portfolio of useful tools.

---

## üöÄ Future Improvements

- HTML reporting  
- Severity scoring  
- Sysmon integration  
- Real-time monitoring  
- Event correlation logic  

---

## ‚öôÔ∏è Requirements

- Windows 10 / 11  
- PowerShell 5+ or PowerShell 7  
- Administrator privileges  

---

## üìÇ License

MIT License ‚Äì feel free to use and adapt for learning purposes.
